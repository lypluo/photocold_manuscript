summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "red",
"mod_recent_optim" = "steelblue2", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="black",fill="white")
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "red",
"mod_recent_optim" = "steelblue2", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white")
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "red",
"mod_recent_optim" = "steelblue2", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "red",
"mod_recent_optim" = "steelblue2", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
legend.background = "white",
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "red",
"mod_recent_optim" = "steelblue2", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
legend.background = element_rect(fill="white"),
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "red",
"mod_recent_optim" = "steelblue2", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "red",
"mod_recent_optim" = "steelblue2", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue2", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "forestgreen", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue1", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
#update using original p-model
season_plot<-df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue1", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
ggsave(paste0(save.path,"Figure4_pmodel_vs_obs.png"),season_plot,width = 15,height = 10)
#save the plot
save.path<-"./manuscript/figures/"
ggsave(paste0(save.path,"Figure4_pmodel_vs_obs.png"),season_plot,width = 15,height = 10)
#update using original p-model
season_plot<-df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue1", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
legend.text = element_text(size=20),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
#print the plot
season_plot
#save the plot
save.path<-"./manuscript/figures/"
ggsave(paste0(save.path,"Figure4_pmodel_vs_obs.png"),season_plot,width = 15,height = 10)
#update using original p-model
season_plot<-df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue3", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
legend.text = element_text(size=20),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
#print the plot
season_plot
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue4", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
legend.text = element_text(size=20),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "blue", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
legend.text = element_text(size=20),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue1", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
legend.text = element_text(size=20),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
#update using original p-model
season_plot<-df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual(values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue1", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
legend.text = element_text(size=20),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
#print the plot
season_plot
#save the plot
save.path<-"./manuscript/figures/"
ggsave(paste0(save.path,"Figure4_pmodel_vs_obs.png"),season_plot,width = 15,height = 10)
#update using original p-model
season_plot<-df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual("GPP sources",values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue1", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","Obs.")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
legend.text = element_text(size=20),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
#print the plot
season_plot
#save the plot
save.path<-"./manuscript/figures/"
ggsave(paste0(save.path,"Figure4_pmodel_vs_obs.png"),season_plot,width = 15,height = 10)
#update using original p-model
season_plot<-df_modobs %>%
mutate(doy = lubridate::yday(date)) %>%
group_by(Clim_PFTs, doy) %>%
summarise(obs = mean(gpp_obs, na.rm = TRUE),
mod_old_ori=mean(gpp_mod_old_ori, na.rm = TRUE),
mod_recent_ori=mean(gpp_mod_recent_ori, na.rm = TRUE),
mod_recent_optim=mean(gpp_mod_recent_optim,na.rm = TRUE)) %>%
pivot_longer(c(obs,mod_old_ori,mod_recent_optim), names_to = "Source", values_to = "gpp") %>%
ggplot(aes(doy, gpp, color = Source)) +
geom_line() +
scale_color_manual("GPP sources",values = c("mod_old_ori" = "tomato",
"mod_recent_optim" = "steelblue1", "obs" = "black"),
labels = c("Orig. P-model", "Cali. P-model","EC based")) +
labs(y = expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ),
x = "Day of year") +
annotate(geom="text",x=200,y=2,label="")+
facet_wrap(~Clim_PFTs)+
theme(
legend.text = element_text(size=20),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.75,0.1)
)
#print the plot
season_plot
#save the plot
save.path<-"./manuscript/figures/"
ggsave(paste0(save.path,"Figure4_pmodel_vs_obs.png"),season_plot,width = 15,height = 10)
