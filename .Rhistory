geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[150],y=0,label="PRP",size=6)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
#manually to define the doy to fulfill the demonstration purpose
rect.coord_GS=data.frame(x1=df_subset$date[115],
x2=df_subset$date[198],
y1=min(df_subset$gpp_mod_norm,na.rm = T)-0.5,
y2=max(df_subset$gpp_mod_norm,na.rm = T)+0.5)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[150],y=0,label="PRP",size=6)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[150],y=0,label="PRP",size=6)+
ylim(-0.05,1)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
#manually to define the doy to fulfill the demonstration purpose
rect.coord_GS=data.frame(x1=df_subset$date[115],
x2=df_subset$date[198],
y1=min(df_subset$gpp_mod_norm,na.rm = T)-0.05,
y2=max(df_subset$gpp_mod_norm,na.rm = T)+0.05)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[150],y=0,label="PRP",size=6)+
ylim(-0.05,1)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[150],y=0,label="PRP",size=6)+
ylim(-0.05,1.05)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
rect.coord_GS
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[150],y=0,label="PRP",size=6)+
ylim(-0.05,1.16)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[160],y=0,label="PRP",size=6)+
annotate(geom = "text",x=c(df_subset$date[105],df_subset$date[205]),
y=rep(0.2,1),label=c("SOS","POS"),size=6)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[160],y=0,label="PRP",size=6)+
annotate(geom = "text",x=c(df_subset$date[100],df_subset$date[215],df_subset$date[315]),
y=rep(0.2,3),label=c("SOS","POS","EOS"),size=6)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[160],y=0,label="PRP",size=6)+
annotate(geom = "text",x=c(df_subset$date[95],df_subset$date[215],df_subset$date[318]),
y=rep(0.2,3),label=c("SOS","POS","EOS"),size=6)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[160],y=0,label="PRP",size=6)+
annotate(geom = "text",x=c(df_subset$date[95],df_subset$date[215],df_subset$date[318]),
y=rep(0.2,3),label=c("SOS","POS","EOS"),size=5)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[160],y=0,label="PRP",size=6)+
annotate(geom = "text",x=c(df_subset$date[95],df_subset$date[215],df_subset$date[318]),
y=rep(0.2,3),label=c("SOS","POS","EOS"),size=4)+
ylim(-0.05,1.16)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
gg_plot<-ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[160],y=0,label="PRP",size=6)+
annotate(geom = "text",x=c(df_subset$date[95],df_subset$date[215],df_subset$date[318]),
y=rep(0.2,3),label=c("SOS","POS","EOS"),size=4)+
ylim(-0.05,1.16)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
#
save.path<-"./manuscript/test_files/phenophase_definition/"
gg_plot<-ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#adding text:
annotate(geom = "text",x=df_subset$date[160],y=0,label="PRP",size=6)+
annotate(geom = "text",x=c(df_subset$date[95],df_subset$date[215],df_subset$date[318]),
y=rep(0.2,3),label=c("SOS","POS","EOS"),size=4)+
ylim(-0.05,1.16)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
#
save.path<-"./manuscript/test_files/phenophase_definition/"
ggsave(paste0(save.path,"gpp_phenophase_define.png"),gg_plot)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#
geom_vline(yintercept = c(0,1),col=adjustcolor("steelblue2",0.3))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
geom_vline(xintercept = df_subset[df_subset$over_estim=="yes",]$date,col=adjustcolor("steelblue2",0.3))+
#
geom_hline(yintercept = c(0,1),col=adjustcolor("steelblue2",0.3))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
#
geom_hline(yintercept = c(0,1),col=adjustcolor("steelblue2",0.3))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
#
geom_hline(yintercept = c(0,1.1),col=adjustcolor("grey",0.5),size=1.1,lty=2)+
#adding text:
annotate(geom = "text",x=df_subset$date[160],y=0,label="PRP",size=6)+
annotate(geom = "text",x=c(df_subset$date[95],df_subset$date[215],df_subset$date[318]),
y=rep(0.2,3),label=c("SOS","POS","EOS"),size=4)+
ylim(-0.05,1.16)+
theme_classic()+
theme(axis.ticks.x = element_blank(),
axis.text.x  = element_blank(),
axis.title = element_text(size=20),
legend.position = c(0.15,0.9),
legend.background = element_blank())
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(x = df_subset$date[115],y=0.05,xend=df_subset$date[115],yend=0.2,
col="forestgreen",lty=2,lwd=1.2)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(x = df_subset$date[115],y=0.05,xend=df_subset$date[115],yend=0.2,
col="forestgreen",lty=2,lwd=1.2)
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(x = x,y=y,xend=x1,yend=y1,
col="forestgreen",lty=2,lwd=1.2,
data = data.frame(x=df_subset$date[115],y=0.05,
x1=df_subset$date[115],y1=0.2))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(x=x1,y=y1,xend=x2,yend=y2,
col="forestgreen",lty=2,lwd=1.2,
data = data.frame(x1=df_subset$date[115],y1=0.05,
x2=df_subset$date[115],y2=0.2))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.2,
data = data.frame(x1=df_subset$date[115],y1=0.05,
x2=df_subset$date[115],y2=0.2))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.2,
data = data.frame(x1=df_subset$date[115],y1= -0.05,
x2=df_subset$date[115],y2=0.2))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.15,
data = data.frame(x1=df_subset$date[115],y1= -0.05,
x2=df_subset$date[115],y2=0.2))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[115],y1= -0.05,
x2=df_subset$date[115],y2=0.2))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[115],y1= -0.05,
x2=df_subset$date[115],y2=0.18))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[115],y1= -0.05,
x2=df_subset$date[115],y2=0.18))+
# geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[198],y1= -0.05,
x2=df_subset$date[198],y2=1.1))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[115],y1= -0.05,
x2=df_subset$date[115],y2=0.18))+
# geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[198],y1= -0.05,
x2=df_subset$date[198],y2=1.05))
ggplot() +
# geom_point(data=df_subset,aes(x=date,y = gpp_mod_norm),col=adjustcolor("tomato",0.5),pch=1)+
# geom_line(data=df_subset,aes(x=date,y = gpp_mod_roll20,col="modelled"),lwd=1.2)+
#using the observation to make the plot
geom_point(data=df_subset,aes(x=date,y = gpp_obs_norm),col=adjustcolor("black",0.5),pch=1)+
geom_line(data=df_subset,aes(x=date,y = gpp_obs_roll20),lwd=1.2)+
#manually to define the doy to fulfill the demonstration purpose
# geom_vline(xintercept = df_subset$date[115],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[115],y1= -0.05,
x2=df_subset$date[115],y2=0.18))+
# geom_vline(xintercept = df_subset$date[198],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[198],y1= -0.05,
x2=df_subset$date[198],y2=1.05))+
# geom_vline(xintercept = df_subset$date[300],col="forestgreen",lty=2,lwd=1.2)+
geom_segment(aes(x=x1,y=y1,xend=x2,yend=y2),
col="forestgreen",lty=2,lwd=1.1,
data = data.frame(x1=df_subset$date[300],y1= -0.05,
x2=df_subset$date[300],y2=0.18))+
labs(title = "", x = "DoY", y = "Norm GPP" )+  #(g C m-2 d-1 )
geom_rect(data=rect.coord_GS,mapping=aes(xmin=x1, xmax=x2, ymin=y1, ymax=y2), fill="green3",alpha=0.1)+
#
geom_hline(yintercept = c(0,1.1),col=adjustcolor("grey",0.5),size=1.1,lty=2)
