#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
# geom_line()+
geom_smooth(aes(group=temp),method = "loess")+
scale_color_continuous_sequential(palette = "OrYel",rev = T)
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
# geom_line()+
geom_smooth(aes(group=temp),method = "loess",se=F)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)
df_merge_new %>%
dplyr::filter(classid=="DBF")%>%
mutate(doy=yday(date))%>%
dplyr::select(sitename,doy,gpp_obs)%>%
group_by(sitename)%>%
mutate(gpp_obs_95=quantile(gpp_obs))
(gpp_obs_95=quantile(gpp_obs,prob=0.95,na.rm=T))
t<-df_merge_new %>%
dplyr::filter(classid=="DBF")%>%
mutate(doy=yday(date))%>%
dplyr::select(sitename,doy,gpp_obs)%>%
group_by(sitename)
head(t)
quantile()
?quantile
df_merge_new %>%
dplyr::filter(classid=="DBF")%>%
mutate(doy=yday(date))%>%
dplyr::select(sitename,doy,gpp_obs)%>%
group_by(sitename)%>%
mutate(gpp_obs_95=quantile(gpp_obs,probs=0.95,na.rm=T))
GPP_merge<-df_merge_new %>%
dplyr::filter(classid=="DBF")%>%
mutate(doy=yday(date))%>%
dplyr::select(sitename,doy,gpp_obs)%>%
group_by(sitename)%>%
mutate(gpp_obs_95=quantile(gpp_obs,probs=0.95,na.rm=T))%>%
mutate(gpp_norm=gpp_obs/gpp_obs_95)%>%
dplyr::select(sitename,doy,gpp_norm)%>%
group_by(sitename,doy)%>%
dplyr::summarise(obs=mean(gpp_norm,na.rm=T))
head(GPP_merge)
#merge GPP_merge with general Climates condition in different sites:
df_plot_final<-left_join(GPP_merge,df_final_new)
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab()
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")
?geom_smooth
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=5)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=10)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=3)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=12)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=15)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=20)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))
head(df_plot_final)
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(fill=guide_legend(title=expression(T[mean])))
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(fill=guide_legend(title=expression(T[mean])))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(fill=guide_legend(title="Mean Ta"))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title="Mean Ta"))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[min])))
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean]))) ##change the legend title
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
# legend.background = element_blank(),
legend.position = c(0.5,0.25)
)
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
legend.background = element_blank()
)
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
# panel.background = element_rect(colour ="grey",fill="white"),
legend.background = element_blank()
)
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
legend.background = element_rect(fill="white")
)
#-------
#plotting
#-------
df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white")
)
#-------
#plotting
#-------
df_plot<-df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white")
)
#-------
#plotting
#-------
df_plot<-df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
legend.background = element_rect(fill="white")
)
print(df_plot)
#-------
#plotting
#-------
df_plot<-df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white"),
legend.background = element_rect(fill="blue")
)
print(df_plot)
#-------
#plotting
#-------
df_plot<-df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(fill="white")
)
print(df_plot)
#-------
#plotting
#-------
df_plot<-df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white")
)
print(df_plot)
#-------
#plotting
#-------
df_plot<-df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression( paste("GPP (g C m"^-2, " d"^-1, ")" ) ))+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white")
)
print(df_plot)
#save the plot
save.path<-"./manuscript/figures/"
ggsave(paste0(save.path,"FigureS_GPP_cycle_for_diffT.png"),paras_boxplot)
ggsave(paste0(save.path,"FigureS_GPP_cycle_for_diffT.png"),df_plot)
#-------
#plotting
#-------
df_plot<-df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression("GPP"[EC]*" (g C m"^-2, " d"^-1, ")" ) )+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white")
)
print(df_plot)
#-------
#plotting
#-------
df_plot<-df_plot_final%>%
ggplot(aes(doy,obs,col=temp))+
geom_point()+
geom_smooth(aes(group=temp),method = "loess",se=F,n=30)+
scale_color_continuous_sequential(palette = "OrYel",rev = T)+
xlab("DoY")+
ylab(expression("GPP"[EC]*" (g C m"^-2, " d"^-1, ")" ) )+
guides(color=guide_legend(title=expression(T[mean])))+##change the legend title
theme(
legend.text = element_text(size=20),
legend.key.size = unit(2, 'lines'),
axis.title = element_text(size=24),
axis.text = element_text(size = 20),
text = element_text(size=24),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.background = element_rect(colour ="grey",fill="white")
)
print(df_plot)
#save the plot
save.path<-"./manuscript/figures/"
ggsave(paste0(save.path,"FigureS_GPP_cycle_for_diffT.png"),df_plot)
